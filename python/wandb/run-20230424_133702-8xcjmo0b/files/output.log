> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(156)<module>()
-> u_0_train = jrand.normal(rng, (100,))
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(157)<module>()
-> u_0_test = jnp.concatenate((u_0_train[0], jnp.ones((1,1))), None)
Array([-1.9810703 ,  1.0481724 ,  0.8898191 ,  0.035166  , -0.9473585 ,
        0.85125655,  0.0312455 , -0.38968593,  0.01320801, -0.42052191,
       -1.2335656 , -1.2524313 ,  0.98738754,  0.80595386, -0.41083032,
        0.9738211 , -0.6879051 , -0.79305184, -1.973272  ,  0.15538813,
       -0.5808592 ,  1.5863018 ,  0.28492707,  0.63823265,  0.06069284,
        0.39795223, -0.22721659, -0.7053813 ,  0.6570658 , -1.8061262 ,
        1.0407923 , -1.9712908 , -0.06924485,  0.60396975, -0.38382423,
        0.32502025,  0.28134054, -1.5120755 ,  0.874926  , -0.79578525,
        0.37597522, -0.4551476 ,  0.13549148,  1.2002596 ,  1.7405769 ,
        0.98859143, -0.02708917, -1.184509  , -0.9568104 ,  0.9804613 ,
        0.2211316 ,  0.48654258,  1.6977485 ,  0.20131212, -0.58212173,
       -0.39210144,  0.05007881,  2.0786808 ,  0.1626376 , -0.6914365 ,
        0.48800626,  1.7702677 , -0.05003558,  1.2240386 ,  0.54848504,
        1.6315418 ,  0.46113688, -0.14762828, -0.33743805,  1.6594526 ,
       -0.49842522,  0.5507005 ,  1.1503136 ,  0.27862296,  0.2728574 ,
       -0.75051147,  0.09124698,  1.7738531 , -1.3945004 ,  0.06694868,
        1.0768479 ,  0.3806326 , -0.08591544, -0.47825667, -0.16346626,
       -0.04134207, -0.22019544,  0.6280466 , -1.0250261 ,  0.44145223,
       -1.3748066 , -1.6925108 , -0.8037043 , -0.08673664,  0.63225734,
       -0.7307739 , -0.76817393,  2.3627229 ,  1.1683888 , -0.2267956 ],      dtype=float32)
(100,)
()
Restarting /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py with arguments:
	Main_no_matrix.py
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(156)<module>()
-> u_0_train = jrand.normal(rng, (100,))
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(157)<module>()
-> u_0_test = jnp.concatenate((jnp.array([u_0_train[0]]), jnp.ones((1,1))), None)
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(159)<module>()
-> while err_total > tol and it <= maxit:
Array([-1.9810703,  1.       ], dtype=float32)
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(107)trainStep()
-> vmap(grad(lossFn, argnums=(3,)), in_axes=(0, None))(u_0, t, dt, params,
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 162, in <module>
    params, opt_state = trainStep(u_0_train, t, dt, params, net, opt_state)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 107, in trainStep
    vmap(grad(lossFn, argnums=(3,)), in_axes=(0, None))(u_0, t, dt, params,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 1250, in vmap_f
    in_axes_flat = flatten_axes("vmap in_axes", in_tree, (in_axes, 0), kws=True)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api_util.py", line 438, in flatten_axes
    raise ValueError(f"{name} specification must be a tree prefix of the "
jax._src.traceback_util.UnfilteredStackTrace: ValueError: vmap in_axes specification must be a tree prefix of the corresponding value, got specification (0, None) for value tree PyTreeDef((*, *, *, CustomNode(FrozenDict[('params',)], [{'Dense_0': {'bias': *, 'kernel': *}, 'Dense_1': {'bias': *, 'kernel': *}, 'Dense_2': {'bias': *, 'kernel': *}}]), *)).
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 162, in <module>
    params, opt_state = trainStep(u_0_train, t, dt, params, net, opt_state)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 107, in trainStep
    vmap(grad(lossFn, argnums=(3,)), in_axes=(0, None))(u_0, t, dt, params,
ValueError: vmap in_axes specification must be a tree prefix of the corresponding value, got specification (0, None) for value tree PyTreeDef((*, *, *, CustomNode(FrozenDict[('params',)], [{'Dense_0': {'bias': *, 'kernel': *}, 'Dense_1': {'bias': *, 'kernel': *}, 'Dense_2': {'bias': *, 'kernel': *}}]), *)).
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 162, in <module>
    for ep in range(n_epochs):
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 107, in trainStep
    vmap(grad(lossFn, argnums=(3,)),
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 1250, in vmap_f
    in_axes_flat = flatten_axes("vmap in_axes", in_tree, (in_axes, 0), kws=True)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api_util.py", line 438, in flatten_axes
    raise ValueError(f"{name} specification must be a tree prefix of the "
jax._src.traceback_util.UnfilteredStackTrace: ValueError: vmap in_axes specification must be a tree prefix of the corresponding value, got specification (0, None) for value tree PyTreeDef((*, *, *, CustomNode(FrozenDict[('params',)], [{'Dense_0': {'bias': *, 'kernel': *}, 'Dense_1': {'bias': *, 'kernel': *}, 'Dense_2': {'bias': *, 'kernel': *}}]), *)).
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 162, in <module>
    for ep in range(n_epochs):
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 107, in trainStep
    vmap(grad(lossFn, argnums=(3,)),
ValueError: vmap in_axes specification must be a tree prefix of the corresponding value, got specification (0, None) for value tree PyTreeDef((*, *, *, CustomNode(FrozenDict[('params',)], [{'Dense_0': {'bias': *, 'kernel': *}, 'Dense_1': {'bias': *, 'kernel': *}, 'Dense_2': {'bias': *, 'kernel': *}}]), *)).
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1732, in <module>
    pdb.main()
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1724, in main
    pdb.interaction(None, t)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 357, in interaction
    self._cmdloop()
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 322, in _cmdloop
    self.cmdloop()
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/cmd.py", line 138, in cmdloop
    stop = self.onecmd(line)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 423, in onecmd
    return cmd.Cmd.onecmd(self, line)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/cmd.py", line 217, in onecmd
    return func(arg)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1032, in do_run
    raise Restart
pdb.Restart