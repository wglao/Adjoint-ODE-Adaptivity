> /scratch/07169/wgl/adjoint/python/Main_no_matrix.py(144)metricCalc()
-> return loss, err
Array([0.26982665, 2.1676059 ], dtype=float32)
Restarting /scratch/07169/wgl/adjoint/python/Main_no_matrix.py with arguments:
	
> /scratch/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
> /scratch/07169/wgl/adjoint/python/Main_no_matrix.py(144)metricCalc()
-> return loss, err
Array(0.26982665, dtype=float32)
Array(0.39115226, dtype=float32)
Deleted breakpoint 1 at /scratch/07169/wgl/adjoint/python/Main_no_matrix.py:144
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/scratch/07169/wgl/adjoint/python/Main_no_matrix.py", line 207, in <module>
    v = adjointSolve(u, dt, ref_factor, params, net)
  File "/scratch/07169/wgl/adjoint/python/Main_no_matrix.py", line 65, in adjointSolve
    dJdU = grad(outFnl)(u_fine, t_fine)
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 659, in grad_f
    _, g = value_and_grad_f(*args, **kwargs)
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 735, in value_and_grad_f
    ans, vjp_py = _vjp(f_partial, *dyn_args, reduce_axes=reduce_axes)
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 2258, in _vjp
    out_primal, out_vjp = ad.vjp(
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/ad.py", line 139, in vjp
    out_primals, pvals, jaxpr, consts = linearize(traceable, *primals)
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/ad.py", line 128, in linearize
    jaxpr, out_pvals, consts = pe.trace_to_jaxpr_nounits(jvpfun_flat, in_pvals)
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 771, in trace_to_jaxpr_nounits
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/scratch/07169/wgl/adjoint/python/Main_no_matrix.py", line 55, in outFnl
    true = integrate.odeint(odeFn, u[0], t[jnp.array([0, -1])])
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/scipy/integrate/_odepack_py.py", line 242, in odeint
    output = _odepack.odeint(func, y0, t, args, Dfun, col_deriv, ml, mu,
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/core.py", line 576, in __array__
    raise TracerArrayConversionError(self)
jax._src.traceback_util.UnfilteredStackTrace: jax._src.errors.TracerArrayConversionError: The numpy.ndarray conversion method __array__() was called on the JAX Tracer object Traced<ConcreteArray(1.0, dtype=float32)>with<JVPTrace(level=2/0)> with
  primal = Array(1., dtype=float32)
  tangent = Traced<ShapedArray(float32[])>with<JaxprTrace(level=1/0)> with
    pval = (ShapedArray(float32[]), None)
    recipe = JaxprEqnRecipe(eqn_id=<object object at 0x15272805ebc0>, in_tracers=(Traced<ShapedArray(float32[]):JaxprTrace(level=1/0)>,), out_tracer_refs=[<weakref at 0x152728098ea0; to 'JaxprTracer' at 0x1527280989f0>], out_avals=[ShapedArray(float32[])], primitive=copy, params={}, effects=set(), source_info=SourceInfo(traceback=<jaxlib.xla_extension.Traceback object at 0x1527280a4db0>, name_stack=NameStack(stack=(Transform(name='jvp'),))))
See https://jax.readthedocs.io/en/latest/errors.html#jax.errors.TracerArrayConversionError
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.7/lib/python3.9/pdb.py", line 1723, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.7/lib/python3.9/pdb.py", line 1583, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.7/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch/07169/wgl/adjoint/python/Main_no_matrix.py", line 207, in <module>
    v = adjointSolve(u, dt, ref_factor, params, net)
  File "/scratch/07169/wgl/adjoint/python/Main_no_matrix.py", line 65, in adjointSolve
    dJdU = grad(outFnl)(u_fine, t_fine)
  File "/scratch/07169/wgl/adjoint/python/Main_no_matrix.py", line 55, in outFnl
    true = integrate.odeint(odeFn, u[0], t[jnp.array([0, -1])])
  File "/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/scipy/integrate/_odepack_py.py", line 242, in odeint
    output = _odepack.odeint(func, y0, t, args, Dfun, col_deriv, ml, mu,
jax._src.errors.TracerArrayConversionError: The numpy.ndarray conversion method __array__() was called on the JAX Tracer object Traced<ConcreteArray(1.0, dtype=float32)>with<JVPTrace(level=2/0)> with
  primal = Array(1., dtype=float32)
  tangent = Traced<ShapedArray(float32[])>with<JaxprTrace(level=1/0)> with
    pval = (ShapedArray(float32[]), None)
    recipe = JaxprEqnRecipe(eqn_id=<object object at 0x15272805ebc0>, in_tracers=(Traced<ShapedArray(float32[]):JaxprTrace(level=1/0)>,), out_tracer_refs=[<weakref at 0x152728098ea0; to 'JaxprTracer' at 0x1527280989f0>], out_avals=[ShapedArray(float32[])], primitive=copy, params={}, effects=set(), source_info=SourceInfo(traceback=<jaxlib.xla_extension.Traceback object at 0x1527280a4db0>, name_stack=NameStack(stack=(Transform(name='jvp'),))))
See https://jax.readthedocs.io/en/latest/errors.html#jax.errors.TracerArrayConversionError
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/scipy/integrate/_odepack_py.py(242)odeint()
-> output = _odepack.odeint(func, y0, t, args, Dfun, col_deriv, ml, mu,
Post mortem debugger finished. The /scratch/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
Program interrupted. (Use 'cont' to resume).
> /work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/core.py(1494)__init__()
-> self.dtype = _dtype_object(dtype)
/work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/plotly/matplotlylib/renderer.py:647: UserWarning:
Looks like the annotation(s) you are trying
to draw lies/lay outside the given figure size.
Therefore, the resulting Plotly figure may not be
large enough to view the full text. To adjust
the size of the figure, use the 'width' and
'height' keys in the Layout object. Alternatively,
use the Margin object to adjust the figure's margins.
Program interrupted. (Use 'cont' to resume).
--Call--
> /work/07169/wgl/ls6/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py(1768)getvar()
-> def getvar(self, tracer):