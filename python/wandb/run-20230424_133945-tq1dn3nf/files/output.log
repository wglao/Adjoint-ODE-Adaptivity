Traceback (most recent call last):
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 1273, in _get_axis_size
    return shape[axis]
IndexError: tuple index out of range
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 1, in <module>
    import os
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 107, in trainStep
    vmap(grad(lossFn, argnums=(3,)),
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 1253, in vmap_f
    out_flat = batching.batch(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 659, in grad_f
    _, g = value_and_grad_f(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 735, in value_and_grad_f
    ans, vjp_py = _vjp(f_partial, *dyn_args, reduce_axes=reduce_axes)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 2258, in _vjp
    out_primal, out_vjp = ad.vjp(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/ad.py", line 139, in vjp
    out_primals, pvals, jaxpr, consts = linearize(traceable, *primals)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/ad.py", line 128, in linearize
    jaxpr, out_pvals, consts = pe.trace_to_jaxpr_nounits(jvpfun_flat, in_pvals)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 771, in trace_to_jaxpr_nounits
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 99, in lossFn
    u = vmap(forwardSolve, in_axes=(0, None, None, None))(u_0, dt, params, net)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 1252, in vmap_f
    _mapped_axis_size(fun, in_tree, args_flat, in_axes_flat, "vmap"))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 1282, in _mapped_axis_size
    sizes = core.dedup_referents(_get_axis_size(name, np.shape(x), d)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/core.py", line 1240, in dedup_referents
    return list({HashableWrapper(get_referent(x)):x for x in itr}.values())
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/core.py", line 1240, in <dictcomp>
    return list({HashableWrapper(get_referent(x)):x for x in itr}.values())
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 1282, in <genexpr>
    sizes = core.dedup_referents(_get_axis_size(name, np.shape(x), d)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 1277, in _get_axis_size
    raise ValueError(
jax._src.traceback_util.UnfilteredStackTrace: ValueError: vmap was requested to map its argument along axis 0, which implies that its rank should be at least 1, but is only 0 (its shape is ())
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 1, in <module>
    import os
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 107, in trainStep
    vmap(grad(lossFn, argnums=(3,)),
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 99, in lossFn
    u = vmap(forwardSolve, in_axes=(0, None, None, None))(u_0, dt, params, net)
ValueError: vmap was requested to map its argument along axis 0, which implies that its rank should be at least 1, but is only 0 (its shape is ())
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(99)lossFn()
-> u = vmap(forwardSolve, in_axes=(0, None, None, None))(u_0, dt, params, net)
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(21)forwardFn()
-> return net.apply({'params': params}, u[-1], t[-1], dt)
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 1, in <module>
    import os
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 107, in trainStep
    vmap(grad(lossFn, argnums=(3,)),
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 1253, in vmap_f
    out_flat = batching.batch(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 659, in grad_f
    _, g = value_and_grad_f(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 735, in value_and_grad_f
    ans, vjp_py = _vjp(f_partial, *dyn_args, reduce_axes=reduce_axes)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 2258, in _vjp
    out_primal, out_vjp = ad.vjp(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/ad.py", line 139, in vjp
    out_primals, pvals, jaxpr, consts = linearize(traceable, *primals)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/ad.py", line 128, in linearize
    jaxpr, out_pvals, consts = pe.trace_to_jaxpr_nounits(jvpfun_flat, in_pvals)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 771, in trace_to_jaxpr_nounits
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 99, in lossFn
    u = forwardSolve(u_0, dt, params, net)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 31, in forwardSolve
    u_next = forwardFn(u[:l + 1], t[:l + 1], dt_l, params, net)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 21, in forwardFn
    return net.apply({'params': params}, u[-1], t[-1], dt)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/flax/linen/module.py", line 1470, in apply
    return apply(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/flax/core/scope.py", line 929, in wrapper
    raise errors.ApplyScopeInvalidVariablesStructureError(variables)
jax._src.traceback_util.UnfilteredStackTrace: flax.errors.ApplyScopeInvalidVariablesStructureError: Expect the `variables` (first argument) passed to apply() to be a dict with the structure {"params": ...}, but got a dict with an extra params layer, i.e.  {"params": {"params": ... } }. You should instead pass in your dict's ["params"]. (https://flax.readthedocs.io/en/latest/api_reference/flax.errors.html#flax.errors.ApplyScopeInvalidVariablesStructureError)
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 1, in <module>
    import os
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 107, in trainStep
    vmap(grad(lossFn, argnums=(3,)),
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 99, in lossFn
    u = forwardSolve(u_0, dt, params, net)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 31, in forwardSolve
    u_next = forwardFn(u[:l + 1], t[:l + 1], dt_l, params, net)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 21, in forwardFn
    return net.apply({'params': params}, u[-1], t[-1], dt)
flax.errors.ApplyScopeInvalidVariablesStructureError: Expect the `variables` (first argument) passed to apply() to be a dict with the structure {"params": ...}, but got a dict with an extra params layer, i.e.  {"params": {"params": ... } }. You should instead pass in your dict's ["params"]. (https://flax.readthedocs.io/en/latest/api_reference/flax.errors.html#flax.errors.ApplyScopeInvalidVariablesStructureError)
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/util.py(415)_broadcast_to()
-> for arr_d, shape_d in safe_zip(arr_shape, shape_tail))
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 1, in <module>
    import os
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 107, in trainStep
    vmap(grad(lossFn, argnums=(3,)),
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 1253, in vmap_f
    out_flat = batching.batch(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 659, in grad_f
    _, g = value_and_grad_f(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 735, in value_and_grad_f
    ans, vjp_py = _vjp(f_partial, *dyn_args, reduce_axes=reduce_axes)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 2258, in _vjp
    out_primal, out_vjp = ad.vjp(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/ad.py", line 139, in vjp
    out_primals, pvals, jaxpr, consts = linearize(traceable, *primals)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/ad.py", line 128, in linearize
    jaxpr, out_pvals, consts = pe.trace_to_jaxpr_nounits(jvpfun_flat, in_pvals)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 771, in trace_to_jaxpr_nounits
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 99, in lossFn
    u = forwardSolve(u_0, dt, params, net)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 32, in forwardSolve
    u = u.at[l + 1].set(u_next)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/array_methods.py", line 478, in wrapped
    return f(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/array_methods.py", line 525, in set
    return scatter._scatter_update(self.array, self.index, values, lax.scatter,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/ops/scatter.py", line 73, in _scatter_update
    return _scatter_impl(x, y, scatter_op, treedef, static_idx, dynamic_idx,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/ops/scatter.py", line 106, in _scatter_impl
    y = jnp.broadcast_to(y, tuple(indexer.slice_shape))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py", line 1117, in broadcast_to
    return util._broadcast_to(array, shape)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/util.py", line 415, in _broadcast_to
    for arr_d, shape_d in safe_zip(arr_shape, shape_tail))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/util.py", line 55, in safe_zip
    assert len(arg) == n, f'length mismatch: {list(map(len, args))}'
jax._src.traceback_util.UnfilteredStackTrace: AssertionError: length mismatch: [1, 0]
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 1, in <module>
    import os
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 107, in trainStep
    vmap(grad(lossFn, argnums=(3,)),
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 99, in lossFn
    u = forwardSolve(u_0, dt, params, net)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 32, in forwardSolve
    u = u.at[l + 1].set(u_next)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/array_methods.py", line 478, in wrapped
    return f(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/array_methods.py", line 525, in set
    return scatter._scatter_update(self.array, self.index, values, lax.scatter,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/ops/scatter.py", line 73, in _scatter_update
    return _scatter_impl(x, y, scatter_op, treedef, static_idx, dynamic_idx,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/ops/scatter.py", line 106, in _scatter_impl
    y = jnp.broadcast_to(y, tuple(indexer.slice_shape))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py", line 1117, in broadcast_to
    return util._broadcast_to(array, shape)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/util.py", line 415, in _broadcast_to
    for arr_d, shape_d in safe_zip(arr_shape, shape_tail))
AssertionError: length mismatch: [1, 0]
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
Breakpoint 1 at /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py:31
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(31)forwardSolve()
-> u_next = forwardFn(u[:l + 1], t[:l + 1], dt_l, params, net)
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(32)forwardSolve()
-> u = u.at[l + 1].set(u_next)
Traced<ShapedArray(float32[1])>with<JVPTrace(level=3/0)> with
  primal = Traced<ShapedArray(float32[1])>with<BatchTrace(level=1/0)> with
    val = Array([[-2.1790519 ],
       [ 0.7027632 ],
       [ 0.5965928 ],
       [ 0.02357758],
       [-1.0420344 ],
       [ 0.570738  ],
       [ 0.02094902],
       [-0.42862982],
       [ 0.00885551],
       [-0.46254745],
       [-1.3568441 ],
       [-1.3775951 ],
       [ 0.66200906],
       [ 0.54036415],
       [-0.45188734],
       [ 0.65291333],
       [-0.756652  ],
       [-0.8723068 ],
       [-2.170474  ],
       [ 0.10418235],
       [-0.6389084 ],
       [ 1.0635604 ],
       [ 0.1910337 ],
       [ 0.42791283],
       [ 0.04069244],
       [ 0.26681316],
       [-0.24992386],
       [-0.77587473],
       [ 0.44053984],
       [-1.9866246 ],
       [ 0.6978151 ],
       [-2.168295  ],
       [-0.07616495],
       [ 0.40494078],
       [-0.42218232],
       [ 0.21791482],
       [ 0.18862905],
       [-1.6631873 ],
       [ 0.58660746],
       [-0.8753134 ],
       [ 0.25207835],
       [-0.50063354],
       [ 0.09084232],
       [ 0.8047325 ],
       [ 1.1669965 ],
       [ 0.66281617],
       [-0.02979638],
       [-1.3028849 ],
       [-1.0524309 ],
       [ 0.6573653 ],
       [ 0.14826106],
       [ 0.32620993],
       [ 1.1382816 ],
       [ 0.1349728 ],
       [-0.64029706],
       [-0.43128672],
       [ 0.0335761 ],
       [ 1.3936834 ],
       [ 0.10904287],
       [-0.76053643],
       [ 0.32719123],
       [ 1.186903  ],
       [-0.05503596],
       [ 0.8206754 ],
       [ 0.3677402 ],
       [ 1.0938921 ],
       [ 0.30917627],
       [-0.16238175],
       [-0.37116048],
       [ 1.1126053 ],
       [-0.5482362 ],
       [ 0.36922556],
       [ 0.77124536],
       [ 0.186807  ],
       [ 0.18294142],
       [-0.8255151 ],
       [ 0.06117794],
       [ 1.189307  ],
       [-1.5338621 ],
       [ 0.04488677],
       [ 0.72198915],
       [ 0.25520095],
       [-0.09450154],
       [-0.52605206],
       [-0.17980252],
       [-0.04547366],
       [-0.24220105],
       [ 0.42108348],
       [-1.1274638 ],
       [ 0.2959784 ],
       [-1.5122001 ],
       [-1.8616548 ],
       [-0.88402385],
       [-0.09540481],
       [ 0.42390662],
       [-0.80380505],
       [-0.8449426 ],
       [ 1.5841237 ],
       [ 0.78336424],
       [-0.24946079]], dtype=float32)
    batch_dim = 0
  tangent = Traced<ShapedArray(float32[1])>with<JaxprTrace(level=2/0)> with
    pval = (ShapedArray(float32[1]), None)
    recipe = JaxprEqnRecipe(eqn_id=<object object at 0x2b9d6be31db0>, in_tracers=(Traced<ShapedArray(float32[1]):JaxprTrace(level=2/0)>,), out_tracer_refs=[<weakref at 0x2b9d6bf5ea90; to 'JaxprTracer' at 0x2b9d6bf5e950>], out_avals=[ShapedArray(float32[1])], primitive=pjit, params={'jaxpr': { lambda ; a:f32[1]. let  in (a,) }, 'in_shardings': (UnspecifiedValue,), 'out_shardings': (UnspecifiedValue,), 'resource_env': None, 'donated_invars': (False,), 'name': 'fn', 'keep_unused': False, 'inline': True}, effects=set(), source_info=SourceInfo(traceback=<jaxlib.xla_extension.Traceback object at 0x2b9d6bf3e070>, name_stack=NameStack(stack=(Transform(name='vmap'), Transform(name='jvp'), Scope(name='ResNetBlock')))))
(1,)
(3,)
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/util.py(415)_broadcast_to()
-> for arr_d, shape_d in safe_zip(arr_shape, shape_tail))
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 163, in <module>
    params, opt_state = trainStep(u_0_train, t, dt, params, net, opt_state)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 107, in trainStep
    vmap(grad(lossFn, argnums=(3,)),
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 1253, in vmap_f
    out_flat = batching.batch(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 659, in grad_f
    _, g = value_and_grad_f(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 735, in value_and_grad_f
    ans, vjp_py = _vjp(f_partial, *dyn_args, reduce_axes=reduce_axes)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 2258, in _vjp
    out_primal, out_vjp = ad.vjp(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/ad.py", line 139, in vjp
    out_primals, pvals, jaxpr, consts = linearize(traceable, *primals)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/ad.py", line 128, in linearize
    jaxpr, out_pvals, consts = pe.trace_to_jaxpr_nounits(jvpfun_flat, in_pvals)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 771, in trace_to_jaxpr_nounits
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 99, in lossFn
    u = forwardSolve(u_0, dt, params, net)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 32, in forwardSolve
    u = u.at[l + 1].set(u_next)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/array_methods.py", line 478, in wrapped
    return f(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/array_methods.py", line 525, in set
    return scatter._scatter_update(self.array, self.index, values, lax.scatter,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/ops/scatter.py", line 73, in _scatter_update
    return _scatter_impl(x, y, scatter_op, treedef, static_idx, dynamic_idx,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/ops/scatter.py", line 106, in _scatter_impl
    y = jnp.broadcast_to(y, tuple(indexer.slice_shape))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py", line 1117, in broadcast_to
    return util._broadcast_to(array, shape)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/util.py", line 415, in _broadcast_to
    for arr_d, shape_d in safe_zip(arr_shape, shape_tail))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/util.py", line 55, in safe_zip
    assert len(arg) == n, f'length mismatch: {list(map(len, args))}'
jax._src.traceback_util.UnfilteredStackTrace: AssertionError: length mismatch: [1, 0]
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 163, in <module>
    params, opt_state = trainStep(u_0_train, t, dt, params, net, opt_state)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 107, in trainStep
    vmap(grad(lossFn, argnums=(3,)),
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 99, in lossFn
    u = forwardSolve(u_0, dt, params, net)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 32, in forwardSolve
    u = u.at[l + 1].set(u_next)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/array_methods.py", line 478, in wrapped
    return f(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/array_methods.py", line 525, in set
    return scatter._scatter_update(self.array, self.index, values, lax.scatter,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/ops/scatter.py", line 73, in _scatter_update
    return _scatter_impl(x, y, scatter_op, treedef, static_idx, dynamic_idx,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/ops/scatter.py", line 106, in _scatter_impl
    y = jnp.broadcast_to(y, tuple(indexer.slice_shape))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py", line 1117, in broadcast_to
    return util._broadcast_to(array, shape)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/util.py", line 415, in _broadcast_to
    for arr_d, shape_d in safe_zip(arr_shape, shape_tail))
AssertionError: length mismatch: [1, 0]
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(31)forwardSolve()
-> u_next = forwardFn(u[:l + 1], t[:l + 1], dt_l, params, net)
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(32)forwardSolve()
-> u = u.at[l + 1].set(u_next)
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(30)forwardSolve()
-> for l, dt_l in enumerate(dt):
Deleted breakpoint 1 at /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py:31
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/util.py(343)check_arraylike()
-> raise TypeError(msg.format(fun_name, type(arg), pos))
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 163, in <module>
    params, opt_state = trainStep(u_0_train, t, dt, params, net, opt_state)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 106, in trainStep
    grads = jnp.mean(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 323, in mean
    return _mean(a, _ensure_optional_axes(axis), dtype, out, keepdims,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 238, in cache_miss
    outs, out_flat, out_tree, args_flat = _python_pjit_helper(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 180, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _ = infer_params_fn(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 311, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 480, in common_infer_params
    jaxpr, consts, canonicalized_out_shardings_flat = _pjit_jaxpr(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 918, in _pjit_jaxpr
    jaxpr, final_consts, out_type = _create_pjit_jaxpr(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 322, in memoized_fun
    ans = call(fun, *args)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 874, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts = pe.trace_to_jaxpr_dynamic(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 2049, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 2066, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 330, in _mean
    check_arraylike("mean", a)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/util.py", line 343, in check_arraylike
    raise TypeError(msg.format(fun_name, type(arg), pos))
jax._src.traceback_util.UnfilteredStackTrace: TypeError: mean requires ndarray or scalar arguments, got <class 'tuple'> at position 0.
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 163, in <module>
    params, opt_state = trainStep(u_0_train, t, dt, params, net, opt_state)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 106, in trainStep
    grads = jnp.mean(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 323, in mean
    return _mean(a, _ensure_optional_axes(axis), dtype, out, keepdims,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 330, in _mean
    check_arraylike("mean", a)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/util.py", line 343, in check_arraylike
    raise TypeError(msg.format(fun_name, type(arg), pos))
TypeError: mean requires ndarray or scalar arguments, got <class 'tuple'> at position 0.
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/util.py(343)check_arraylike()
-> raise TypeError(msg.format(fun_name, type(arg), pos))
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 1, in <module>
    import os
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 106, in trainStep
    def trainStep(u_0, t, dt, params, net, opt_state):
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 323, in mean
    return _mean(a, _ensure_optional_axes(axis), dtype, out, keepdims,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 238, in cache_miss
    outs, out_flat, out_tree, args_flat = _python_pjit_helper(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 180, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _ = infer_params_fn(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 311, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 480, in common_infer_params
    jaxpr, consts, canonicalized_out_shardings_flat = _pjit_jaxpr(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 918, in _pjit_jaxpr
    jaxpr, final_consts, out_type = _create_pjit_jaxpr(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 322, in memoized_fun
    ans = call(fun, *args)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 874, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts = pe.trace_to_jaxpr_dynamic(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 2049, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 2066, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 330, in _mean
    check_arraylike("mean", a)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/util.py", line 343, in check_arraylike
    raise TypeError(msg.format(fun_name, type(arg), pos))
jax._src.traceback_util.UnfilteredStackTrace: TypeError: mean requires ndarray or scalar arguments, got <class 'tuple'> at position 0.
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 1, in <module>
    import os
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 106, in trainStep
    def trainStep(u_0, t, dt, params, net, opt_state):
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 323, in mean
    return _mean(a, _ensure_optional_axes(axis), dtype, out, keepdims,
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 330, in _mean
    check_arraylike("mean", a)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/util.py", line 343, in check_arraylike
    raise TypeError(msg.format(fun_name, type(arg), pos))
TypeError: mean requires ndarray or scalar arguments, got <class 'tuple'> at position 0.
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py(209)<listcomp>()
-> all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 1, in <module>
    import os
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 111, in trainStep
    updates, opt_state = optimizer.update(grads, opt_state)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/combine.py", line 54, in update_fn
    updates, new_s = fn(updates, s, params)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/transform.py", line 342, in update_fn
    mu = update_moment(updates, state.mu, b1, 1)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/transform.py", line 83, in update_moment
    return jax.tree_util.tree_map(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py", line 209, in tree_map
    all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py", line 209, in <listcomp>
    all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
ValueError: Expected tuple, got FrozenDict({
    Dense_0: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32),
    },
    Dense_1: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., ..., 0., 0., 0.],
               [0., 0., 0., ..., 0., 0., 0.],
               [0., 0., 0., ..., 0., 0., 0.],
               ...,
               [0., 0., 0., ..., 0., 0., 0.],
               [0., 0., 0., ..., 0., 0., 0.],
               [0., 0., 0., ..., 0., 0., 0.]], dtype=float32),
    },
    Dense_2: {
        bias: Array([0.], dtype=float32),
        kernel: Array([[0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.]], dtype=float32),
    },
}).
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
Breakpoint 2 at /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py:111
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(111)trainStep()
-> updates, opt_state = optimizer.update(grads, opt_state)
(FrozenDict({
    Dense_0: {
        bias: Array([-9.43212118e-03, -3.55745181e-02,  1.84953734e-02,  5.18432027e-03,
               -4.30663629e-03, -1.84967984e-02, -1.74345840e-02, -9.11191758e-03,
                1.22768776e-02, -8.96834210e-03, -4.64107692e-02, -2.01073065e-02,
                5.59400767e-03, -1.76239274e-02,  4.97116521e-02, -3.41837555e-02,
                1.53625859e-02, -8.30528501e-04,  6.01197220e-03,  1.12498850e-02,
               -1.43782776e-02,  1.62854102e-02, -3.71529013e-02,  1.17670679e-02,
               -7.60763511e-03,  1.12276031e-02,  1.12075815e-02, -9.68586933e-03,
                1.35947438e-02, -8.46538413e-03, -1.06016286e-02, -3.83460149e-02,
                8.43133032e-03, -2.17055846e-02,  3.06336060e-02,  2.76958640e-03,
               -1.45146959e-02,  1.87301468e-02,  4.57825139e-02, -1.87843852e-02,
                2.36019772e-03, -2.51623685e-03, -3.51816453e-02, -2.70178961e-03,
                8.32395814e-03, -3.86348851e-02, -4.13869647e-03,  3.25108320e-02,
                2.93748127e-03,  3.78919356e-02,  3.60602550e-02,  3.71276913e-03,
               -4.74498188e-03, -4.76561673e-03,  7.65612395e-03,  1.68736167e-02,
               -8.51484202e-03,  1.16510957e-03, -2.29395144e-02,  2.19800253e-03,
               -2.41228621e-02,  2.72418763e-02,  2.87875589e-02, -3.20187993e-02,
                7.50676729e-03,  2.81602144e-02,  8.11535120e-03,  1.14069218e-02,
               -4.71808994e-03, -5.76463435e-03, -3.00723966e-02, -8.99431482e-03,
                1.02616167e-02,  1.72888860e-02, -1.40969679e-02, -1.54689699e-02,
               -1.34125706e-02,  1.75748151e-02, -1.31235616e-02, -3.17043415e-03,
               -1.85526218e-02, -2.62038695e-04, -1.61318760e-02,  2.02934947e-02,
               -1.63887609e-02, -1.05622197e-02, -3.43228690e-03,  8.45905859e-03,
               -2.77392603e-02,  6.72752364e-03,  1.50613543e-02,  7.69471342e-04,
                1.45829543e-02,  2.63849013e-02, -1.07069705e-02, -9.64560546e-03,
               -2.56523360e-02, -5.08348830e-02,  1.64971780e-02,  1.91737544e-02,
                3.54916714e-02, -3.21894395e-03,  6.44466979e-03,  4.62342845e-03,
                3.36146876e-02, -5.35019999e-03, -1.06267752e-02,  2.71103233e-02,
               -4.11588550e-02,  2.13658325e-02,  9.59053461e-04, -2.51755379e-02,
                1.40977595e-02,  5.21915825e-03,  7.95629248e-03,  1.82022643e-03,
               -1.58992931e-02,  1.16387224e-02,  2.21164599e-02, -1.71958543e-02,
               -4.78671724e-03,  9.84778069e-03,  4.46890481e-02, -4.26899455e-02,
                8.79210234e-03, -2.36309506e-02,  4.22009267e-02, -6.50208211e-03,
               -8.06888938e-03,  5.42554958e-03,  3.11429072e-02,  6.95383409e-04,
                6.66578489e-05,  7.79026141e-03,  9.16940160e-03, -1.57611128e-02,
               -1.92594044e-02,  1.55360624e-03,  5.84948994e-02,  8.64137989e-03,
               -8.97289533e-03, -3.06169447e-02,  1.61057636e-02,  4.30616215e-02,
               -6.01213006e-03,  4.63105645e-03,  1.47503996e-02, -7.55507732e-04,
                1.39771271e-02, -2.21734717e-02, -1.46962367e-02, -2.42823572e-03,
               -2.15364788e-02, -2.41201296e-02, -2.68398989e-02,  1.36725074e-02,
                1.99033394e-02,  3.61637287e-02,  1.83527488e-02,  4.57892008e-02,
               -1.45257208e-02, -2.71503963e-02,  2.31709937e-03,  5.00932569e-03,
                1.16358325e-02, -1.19925672e-02,  4.57588769e-03, -3.05600595e-02,
               -1.96550898e-02, -1.58938207e-02, -6.39118534e-03, -7.96150940e-04,
                4.44383081e-03,  4.10677586e-03,  2.11215392e-02,  1.75260846e-02,
               -1.19805140e-02,  2.71511450e-02,  6.47627935e-03, -1.49919996e-02,
                3.44043374e-02, -5.68296714e-03, -8.68067704e-03, -6.91202143e-03,
               -1.81153193e-02, -4.66344226e-03, -5.55449612e-02, -1.57957841e-02,
               -6.77278638e-03,  9.66204982e-03,  1.14488718e-03,  2.92647313e-02,
                2.69869268e-02,  2.22170427e-02, -1.02842469e-02, -2.34563220e-02,
               -6.15032343e-03,  3.25709619e-02,  4.94179465e-02,  8.32031853e-03,
                2.07871068e-02,  1.73965481e-03,  6.67448761e-03, -6.90403907e-03,
                1.62238088e-02, -2.30896119e-02,  1.58712873e-03, -2.08551362e-02,
                3.90851758e-02, -2.56365743e-02, -1.40014635e-02, -1.21320402e-02,
                1.66350715e-02, -3.00752614e-02, -7.17891976e-02,  1.41273830e-02,
                3.21314856e-03,  2.64734793e-02, -1.64995193e-02, -8.53987876e-03,
                5.22584841e-02,  4.51006107e-02, -1.57514289e-02,  6.59607258e-03,
               -2.43564118e-02,  3.82763445e-02,  1.11518307e-02,  6.43279850e-02,
               -9.60249268e-03,  4.37772367e-03, -1.05514117e-02,  2.05058642e-02,
                1.02517046e-02, -2.77505592e-02, -4.79350216e-04, -1.24632372e-02,
                2.24328623e-03,  4.19694856e-02, -3.99347581e-02,  9.74446535e-03,
                8.31317157e-02,  1.53394239e-02, -5.80911728e-05, -1.35997124e-02,
                3.36820222e-02, -2.08418034e-02,  1.95899536e-03, -6.31594239e-03,
               -3.53719704e-02,  3.27627175e-02], dtype=float32),
        kernel: Array([[-7.14966282e-03, -2.67930049e-02, -1.33822495e-02,
                -4.92640724e-03,  2.76382733e-03,  1.63054597e-02,
                -1.21878004e-02,  7.93826114e-03,  1.12933181e-02,
                -6.91402284e-03, -2.62028072e-02,  1.02701467e-02,
                -3.54178180e-03,  1.66161582e-02,  3.76820378e-02,
                 9.78147797e-03, -1.19771669e-02, -6.85137929e-04,
                -5.29972650e-03, -9.12375655e-03,  1.35561023e-02,
                -1.03109190e-02, -3.13248523e-02, -1.03730094e-02,
                -6.94919284e-03, -9.54711437e-03, -3.20698321e-03,
                -7.34200701e-03,  1.26304040e-02,  6.86550187e-03,
                 9.99540649e-03, -2.88803577e-02,  6.56786654e-03,
                -1.57909933e-02, -1.02654714e-02,  2.26498512e-03,
                -1.22378254e-02, -1.75620504e-02, -2.16734596e-02,
                -1.51003832e-02,  2.23599840e-03, -1.39192538e-03,
                -2.96628177e-02, -2.03485717e-03,  6.48422586e-03,
                -3.64215560e-02,  3.64837958e-03,  2.99062300e-02,
                 2.65012821e-03, -3.43030356e-02, -1.12794675e-02,
                 3.34957521e-03, -3.69626284e-03,  4.42503160e-03,
                -2.19075382e-03, -1.26957903e-02, -8.11462849e-03,
                 9.02948203e-04,  2.02218387e-02,  2.00776546e-03,
                -2.17630938e-02,  2.05172598e-02, -2.62318086e-02,
                 2.40910985e-02, -6.13130303e-03,  2.21422072e-02,
                -4.14505275e-03, -1.07546533e-02,  4.49423492e-03,
                 5.13860583e-03,  2.17587557e-02, -8.43128283e-03,
                -4.72800015e-03, -1.57834589e-02, -6.78667240e-03,
                 7.90103804e-03, -1.12593314e-02, -1.37018897e-02,
                -1.20579991e-02,  2.87015014e-03, -1.13921678e-02,
                 2.22818271e-04, -1.45538086e-02, -1.71443205e-02,
                 7.55105726e-03,  9.72715393e-03,  3.12075671e-03,
                 6.37095235e-03,  7.93742388e-03, -4.12008166e-03,
                -6.93945866e-03,  7.33304594e-04,  1.20300949e-02,
                 1.27024241e-02,  4.93319426e-03, -8.70204438e-03,
                -2.20079795e-02, -4.84455526e-02,  1.48833776e-02,
                -1.49484761e-02, -1.81279685e-02,  2.64331582e-03,
                -5.83426934e-03, -4.00398998e-03,  2.09170319e-02,
                 5.07776719e-03, -6.22310722e-03,  1.97229888e-02,
                -3.92243154e-02,  1.68770049e-02,  7.84319476e-04,
                 2.05626246e-02,  1.18862940e-02, -4.65236790e-03,
                -4.06381069e-03,  1.69110904e-03, -1.13065811e-02,
                 1.03739155e-02,  1.67645458e-02, -1.35831116e-02,
                 4.48819622e-03, -8.91505834e-03, -2.05903016e-02,
                 3.46219279e-02, -4.49071499e-03, -2.18850300e-02,
                 3.25342380e-02, -5.06501552e-03, -3.88458651e-03,
                 5.17053902e-03, -2.15708185e-02, -3.20395397e-04,
                 6.01369138e-05,  6.23588683e-03, -7.48929288e-03,
                 1.40494881e-02, -9.27201286e-03,  1.17765216e-03,
                 4.22422215e-02,  6.28667558e-03, -8.09514057e-03,
                -2.58141700e-02,  1.53487623e-02,  2.43119281e-02,
                -5.52397827e-03,  3.57025024e-03, -4.94293030e-03,
                 6.54286414e-04,  1.21991979e-02,  6.34480640e-03,
                -1.18140038e-02, -1.91807863e-03,  6.16253540e-03,
                 7.54465582e-03,  7.68007757e-03, -1.24586653e-02,
                -1.01659661e-02, -2.93291081e-02,  1.30513264e-02,
                 3.64930443e-02,  1.36951124e-02, -2.11497117e-02,
                -2.13258644e-03, -4.69692238e-03, -8.41905829e-03,
                 6.94959844e-03,  3.52771860e-03, -2.47776173e-02,
                -1.48032606e-02,  1.47442007e-02,  5.99260302e-03,
                 5.76051883e-04, -4.13769018e-03, -3.66078783e-03,
                 1.53660951e-02,  1.32849859e-02, -9.46348161e-03,
                -2.35134810e-02, -4.32390720e-03, -1.35254376e-02,
                -2.32656691e-02,  5.32855280e-03,  7.89277907e-03,
                 4.67420137e-03, -1.57434344e-02, -4.17400431e-03,
                 1.58938598e-02,  1.29711013e-02,  6.08222932e-03,
                -8.67690053e-03, -9.40152735e-04,  2.04577688e-02,
                -2.56265830e-02, -1.73211209e-02,  6.51135296e-03,
                 2.09090132e-02, -4.79099993e-03,  2.98587177e-02,
                 3.03449035e-02,  4.00563236e-03,  1.00074913e-02,
                -4.97792382e-04,  5.34274103e-03,  5.66942338e-03,
                 1.52082201e-02,  1.46189220e-02,  8.96068290e-04,
                -1.90501213e-02, -1.11839920e-02,  2.01541744e-02,
                -1.27896350e-02, -1.10820113e-02,  1.16288941e-02,
                 8.60585738e-03, -5.44170849e-02, -1.30104506e-02,
                 2.53808615e-03,  2.41821948e-02,  1.24143157e-02,
                 8.10940564e-03,  4.54161502e-02,  2.17126869e-02,
                 9.64651816e-03, -5.57248387e-03, -2.24051010e-02,
                 3.34074832e-02,  5.36880130e-03,  3.09692789e-02,
                -5.89637365e-03, -3.96309234e-03,  9.40554868e-03,
                -1.80765074e-02, -9.28072445e-03, -1.33598894e-02,
                 4.55187255e-04,  1.16859740e-02, -1.84213032e-03,
                 3.86071093e-02, -3.07871569e-02, -9.27185174e-03,
                 6.47582337e-02,  1.22252032e-02,  5.12089537e-05,
                 1.18480083e-02,  2.45039538e-02, -1.80354416e-02,
                -5.60554676e-04, -4.89479117e-03,  1.62974969e-02,
                -2.88812779e-02],
               [-2.01940164e-03, -7.66022783e-03,  3.97955906e-03,
                 5.06514625e-04, -1.01841486e-03, -2.96161580e-03,
                -3.96722648e-03, -1.49964064e-03,  1.64875656e-03,
                -1.88714056e-03, -1.15292622e-02, -5.30074630e-03,
                 1.33459014e-03, -2.04008608e-03,  1.06431823e-02,
                -1.01237725e-02,  3.04500759e-03, -1.58602561e-04,
                 9.62607155e-04,  2.11114669e-03, -1.66438089e-03,
                 3.88529059e-03, -6.79951394e-03,  1.88408454e-03,
                -1.07085810e-03,  1.94374169e-03,  3.31920851e-03,
                -2.07372895e-03,  3.09022347e-04, -1.58860884e-03,
                -1.22720865e-03, -8.25701095e-03,  1.75328576e-03,
                -4.80671227e-03,  8.90058745e-03,  5.36809326e-04,
                -2.65639788e-03,  2.29114783e-03,  1.23810098e-02,
                -3.74248438e-03,  2.20569811e-04, -6.28319394e-04,
                -6.43874612e-03, -5.81773988e-04,  1.73095788e-03,
                -3.97656579e-03, -6.62667502e-04,  4.36612964e-03,
                 0.00000000e+00,  5.60665363e-03,  1.05747674e-02,
                 0.00000000e+00, -9.86713800e-04, -2.26518154e-04,
                 2.26741796e-03,  3.48789152e-03, -6.60879305e-04,
                 2.43726856e-04, -3.67296091e-03,  3.09392926e-04,
                 0.00000000e+00,  5.86596830e-03,  1.03222649e-03,
                -6.61850302e-03,  1.39322784e-03,  5.78708854e-03,
                 2.13939254e-03,  1.32042670e-03, -3.64845153e-04,
                -8.95774341e-04, -6.47053029e-03, -1.00399123e-03,
                 2.79809441e-03,  2.46668607e-03, -3.61635746e-03,
                -4.07797517e-03, -2.47716159e-03,  3.48349148e-03,
                -1.59999792e-04, -4.69111168e-04, -4.49238857e-03,
                -4.53645989e-05,  0.00000000e+00,  3.55576095e-03,
                -4.46881866e-03, -4.42083139e-04, -4.98921378e-04,
                 1.82148104e-03, -8.21518805e-03,  1.63566461e-03,
                 4.10686713e-03,  5.97224935e-05,  2.78484449e-03,
                 6.76863547e-03, -2.91953236e-03,  0.00000000e+00,
                -4.51123575e-03, -3.94554902e-03,  0.00000000e+00,
                 3.80041706e-03,  9.35641769e-03,  0.00000000e+00,
                 9.53581010e-04,  7.71016232e-04,  8.09868705e-03,
                -5.42935100e-04, -2.61295890e-03,  6.00359449e-03,
                -3.19454423e-03,  4.36445093e-03,  1.85886500e-04,
                -4.67248494e-03,  2.58009252e-03,  8.11012171e-04,
                 2.09746091e-03,  4.13756607e-05, -3.57878790e-03,
                 1.82388292e-03,  4.73509822e-03, -3.51263932e-03,
                -5.85530826e-04,  1.45712018e-03,  1.21856229e-02,
                -8.01117066e-03,  2.31779972e-03, -3.00951512e-03,
                 8.88002384e-03, -1.35210098e-03, -2.06994801e-03,
                 4.21104138e-04,  6.96489448e-03,  1.89614220e-04,
                 0.00000000e+00,  1.56212621e-03,  1.70180656e-03,
                -2.44914088e-03, -4.94070025e-03,  3.32624564e-04,
                 1.30247837e-02,  1.91363774e-03,  0.00000000e+00,
                -5.60334092e-03,  1.25004840e-03,  1.06972735e-02,
                -7.32987392e-05,  9.74478316e-04,  4.28572530e-03,
                -1.25990700e-04,  2.34756409e-03, -6.56683790e-03,
                -2.92798760e-03, -4.96021588e-04, -6.37818780e-03,
                -7.07329391e-03, -7.94883631e-03,  4.90250823e-04,
                 5.24697639e-03,  6.78646425e-03,  4.13103914e-03,
                 9.23947245e-03, -1.68144843e-03, -5.64589491e-03,
                 3.17830505e-04,  6.12761243e-04,  2.50362535e-03,
                -2.99854507e-03,  9.62869497e-04, -6.00740081e-03,
                -4.23231209e-03, -2.08922080e-03, -7.81795883e-04,
                -1.71304011e-04,  5.70942007e-04,  6.38157420e-04,
                 4.67737485e-03,  3.75230634e-03, -2.44728895e-03,
                 4.52780304e-03,  1.49003090e-03,  0.00000000e+00,
                 7.84121733e-03, -6.95163733e-04, -1.26183417e-03,
                -1.57534354e-03, -3.07962741e-03, -7.19391974e-04,
                -1.64500531e-02,  0.00000000e+00, -1.99254224e-04,
                 2.84255773e-04,  0.00000000e+00,  6.65916782e-03,
                 1.84151018e-03,  4.40362515e-03, -2.45356350e-03,
                -3.64490971e-03, -1.27895293e-03,  4.48190980e-03,
                 1.19662117e-02,  2.13444792e-03,  5.33260871e-03,
                 5.15211606e-04,  1.33838796e-03,  0.00000000e+00,
                 1.81098457e-03, -5.50860260e-03,  3.94271075e-04,
                -2.93558883e-03,  1.15753645e-02, -5.02706878e-03,
                -1.97085948e-03, -1.70771754e-03,  3.78529890e-03,
                -8.90701171e-03, -1.53699489e-02,  5.91303455e-04,
                 6.56357675e-04,  3.72643233e-03, -3.41056241e-03,
                -5.82736742e-04,  8.88400897e-03,  1.15698585e-02,
                -3.82964942e-03,  1.15574268e-03, -3.27100977e-03,
                 6.42880145e-03,  2.86082854e-03,  1.65023413e-02,
                -2.32517673e-03,  6.47746900e-04, -1.63959828e-03,
                 3.28329694e-03,  1.51688617e-03, -7.11897342e-03,
                -3.27094785e-05, -1.52455422e-03,  0.00000000e+00,
                 5.63640473e-03, -8.40316992e-03,  7.10038177e-04,
                 1.72871482e-02,  3.09523148e-03, -9.30134865e-06,
                -2.23824265e-03,  7.45890057e-03, -3.58478841e-03,
                 5.80170890e-04, -1.32121856e-03, -9.64508299e-03,
                 5.24580339e-03]], dtype=float32),
    },
    Dense_1: {
        bias: Array([-5.92297316e-02,  5.35741411e-02,  8.32663700e-02, -1.40383525e-03,
                6.92349002e-02, -8.73738900e-02,  5.15463799e-02, -2.20570341e-02,
                4.44597676e-02, -6.86434237e-03,  3.19783352e-02, -6.83372542e-02,
               -9.15228054e-02, -1.18861198e-02, -1.61350705e-02, -2.85980459e-02,
                9.74742143e-05, -8.21046457e-02, -7.82160461e-02, -3.10543235e-02,
               -3.98418345e-02, -9.54090059e-03, -1.36604048e-02,  9.28434450e-03,
               -6.11515120e-02, -1.69431102e-02,  7.51215545e-03, -1.02304788e-02,
                2.54794490e-02, -1.60115696e-02, -3.41927558e-02,  3.35483886e-02,
               -4.28348817e-02,  3.13404612e-02, -2.09366176e-02, -3.07079498e-03,
                4.05753776e-02,  4.68644127e-02, -1.63698066e-02,  6.03568628e-02,
               -2.43017767e-02,  7.87033811e-02, -6.95429966e-02,  8.73899926e-03,
                1.75308269e-02,  9.81079414e-03,  7.29874969e-02, -2.64855903e-02,
               -3.79641876e-02,  3.98743944e-03,  2.56576575e-02,  1.15265222e-02,
               -3.49626802e-02,  2.82939095e-02,  3.84899005e-02, -4.61607017e-02,
               -3.07556260e-02, -5.90113960e-02,  3.72840427e-02, -4.83205728e-02,
                4.80694287e-02,  7.54154250e-02, -7.56425178e-03, -1.69056864e-03,
               -4.13391590e-02,  1.18946480e-02,  1.37433689e-02, -1.27207041e-02,
                1.64530557e-02,  7.72175496e-04, -7.82152824e-03, -1.34798782e-02,
               -2.32829526e-02,  9.69040859e-03,  6.96326001e-03,  3.61192636e-02,
                1.55242914e-02, -1.48358569e-02,  2.35836785e-02, -1.56552269e-04,
                5.20682596e-02, -8.12335312e-03,  1.90024152e-02,  3.36927432e-03,
                1.29475659e-02, -9.36336517e-02, -8.01028218e-03, -4.27204594e-02,
               -2.07199878e-03, -3.67377140e-02,  3.55331786e-02,  7.50830173e-02,
                1.56539697e-02, -7.22664893e-02,  2.74838060e-02, -1.20877335e-02,
                5.66893555e-02, -1.10120671e-02, -8.83487705e-03,  5.87811274e-03,
               -6.90019205e-02,  1.52022112e-02,  2.22866461e-02, -6.71430081e-02,
               -1.02633955e-02,  2.63382141e-02,  9.23376828e-02,  3.64921801e-02,
                3.63801531e-02,  4.76511456e-02,  3.13839316e-03, -2.83307824e-02,
               -6.45754300e-03, -2.23714449e-02,  9.14382115e-02,  3.61169986e-02,
                1.02562653e-02,  2.99887862e-02, -5.53834438e-03,  6.81930548e-03,
                2.21797056e-03,  1.60560105e-02, -8.48992616e-02,  2.54079476e-02,
                1.54652720e-04,  1.70853604e-02,  4.03216630e-02, -2.86035482e-02,
               -2.39954423e-02,  1.39649678e-02,  2.50285044e-02, -3.49453911e-02,
               -4.49486002e-02, -8.01269338e-02,  4.17032987e-02,  5.87712741e-03,
               -1.36487596e-02, -8.09492692e-02,  7.57165402e-02,  1.64423999e-03,
                3.81830521e-02, -7.66208246e-02,  9.97216068e-03,  1.74753312e-02,
                2.99052019e-02,  3.08641288e-02,  6.60755038e-02,  3.67676653e-02,
               -4.81862724e-02,  3.67284641e-02,  5.98127116e-03, -5.72612621e-02,
                3.23462747e-02,  4.79284376e-02, -3.44395712e-02,  4.70281718e-03,
               -4.15322781e-02, -4.70594876e-02, -6.08029775e-02,  5.37536554e-02,
               -7.17028528e-02,  5.56241870e-02, -2.23924201e-02, -6.82122679e-03,
               -6.21985644e-02,  2.43370235e-02, -3.81217673e-02,  4.50748056e-02,
               -5.06415628e-02,  2.11575590e-02,  3.42938863e-02, -1.05124805e-02,
                4.46514674e-02, -8.77963603e-02, -5.56567311e-02,  3.25166658e-02,
                2.03020908e-02, -1.61482617e-02, -4.01984453e-02, -4.48956862e-02,
               -1.71855986e-02,  8.18479210e-02,  8.68511386e-03,  6.66968301e-02,
               -9.07618850e-02, -2.14201235e-03, -1.09849526e-02,  3.68465260e-02,
                4.61353213e-02, -8.23423918e-03,  4.70680231e-03, -3.31951305e-02,
               -3.82510088e-02, -8.77794400e-02,  5.89905642e-02,  3.47466506e-02,
               -7.19701350e-02, -6.15429468e-02,  8.68392140e-02,  5.27921766e-02,
                3.54865156e-02,  7.39920698e-03, -2.64483783e-02, -3.71427828e-04,
               -2.15107165e-02, -8.19981471e-02, -5.45906136e-03,  5.43132285e-03,
               -5.05137118e-03,  3.71864322e-03, -9.18045267e-03, -2.57658120e-03,
                1.32697318e-02,  1.50746461e-02, -3.72313410e-02,  2.87166294e-02,
               -4.54350561e-03,  7.18301684e-02, -7.05561787e-02, -5.96412038e-03,
                1.63278002e-02, -1.37956785e-02, -3.47128510e-02,  4.76771407e-03,
               -3.11623383e-02, -3.37471068e-02,  3.26559953e-02, -2.08061431e-02,
                8.98186266e-02,  3.46270651e-02,  5.44083677e-02, -4.37599085e-02,
                1.50796128e-02, -2.62878053e-02, -4.51176008e-03, -5.30201383e-02,
               -4.74301502e-02, -4.17402275e-02,  5.67817912e-02,  5.94135337e-02,
               -2.22990979e-02, -2.61163320e-02, -8.43964815e-02,  2.68116035e-02,
                7.85557404e-02, -5.89696206e-02,  7.17513859e-02, -6.27567172e-02,
                6.81355456e-03, -4.60362993e-02], dtype=float32),
        kernel: Array([[-0.04327369,  0.03914167,  0.06083504, ..., -0.04585053,
                 0.00497803, -0.03363447],
               [-0.0348017 ,  0.03147864,  0.04892495, ..., -0.03687406,
                 0.00400345, -0.02704962],
               [-0.01846197,  0.01669912,  0.02595422, ..., -0.01956134,
                 0.00212379, -0.01434957],
               ...,
               [-0.01604608,  0.01451391,  0.0225579 , ..., -0.01700158,
                 0.00184588, -0.01247181],
               [-0.02463027,  0.02227843,  0.03462573, ..., -0.02609693,
                 0.00283337, -0.01914387],
               [-0.0160266 ,  0.01449629,  0.02253053, ..., -0.01698095,
                 0.00184364, -0.01245667]], dtype=float32),
    },
    Dense_2: {
        bias: Array([-0.6622699], dtype=float32),
        kernel: Array([[ 1.70743391e-01],
               [-2.27325819e-02],
               [-2.91099280e-01],
               [ 1.12521112e-01],
               [ 2.49435045e-02],
               [ 4.62026626e-04],
               [-4.92448688e-01],
               [ 5.67268021e-02],
               [-1.07800844e-03],
               [-3.97697628e-01],
               [-1.02983870e-01],
               [-1.00747906e-01],
               [ 2.37259760e-01],
               [ 1.84890375e-01],
               [-3.41161579e-01],
               [-4.70336050e-01],
               [ 1.01140767e-01],
               [-2.41018265e-01],
               [-2.96624899e-02],
               [-3.91379386e-01],
               [ 3.05427462e-01],
               [ 7.75463760e-01],
               [ 2.72885799e-01],
               [-3.56654435e-01],
               [-3.33782196e-01],
               [ 2.88516641e-01],
               [ 4.98485155e-02],
               [ 4.39781338e-01],
               [ 1.52921110e-01],
               [ 3.62149268e-01],
               [-2.06208974e-01],
               [ 7.77277425e-02],
               [-4.02244739e-02],
               [-2.79395193e-01],
               [ 7.33822942e-01],
               [ 2.05173567e-01],
               [-3.93326692e-02],
               [-2.54946142e-01],
               [-1.55165195e-01],
               [-1.17733376e-02],
               [-1.05515003e-01],
               [ 3.73148508e-02],
               [-4.22691256e-01],
               [ 1.09218463e-01],
               [ 2.73489952e-01],
               [ 8.79466385e-02],
               [-3.39826584e-01],
               [ 6.82808831e-02],
               [ 3.92102301e-01],
               [-2.72249505e-02],
               [-1.12693705e-01],
               [-2.53030479e-01],
               [-3.14492211e-02],
               [-2.72474885e-01],
               [-2.82138102e-02],
               [ 7.77695775e-02],
               [-9.91990417e-02],
               [-2.49074608e-01],
               [ 1.47842750e-01],
               [ 9.36539145e-04],
               [-2.63853192e-01],
               [ 3.67224902e-01],
               [-6.16321564e-02],
               [-1.56221598e-01],
               [ 2.40252111e-02],
               [ 4.40071486e-02],
               [-3.00520230e-02],
               [ 7.52411783e-02],
               [-1.33298248e-01],
               [ 1.64509848e-01],
               [ 4.96128231e-01],
               [-3.92088629e-02],
               [ 2.42996681e-02],
               [-1.95153549e-01],
               [-3.60759616e-01],
               [ 5.37203588e-02],
               [ 2.70779748e-02],
               [-1.80074498e-01],
               [ 5.76799363e-02],
               [ 9.73522514e-02],
               [ 2.29816094e-01],
               [-1.42315337e-02],
               [ 2.88371414e-01],
               [-1.28761232e-01],
               [-2.22586244e-01],
               [-3.29810470e-01],
               [ 2.32663080e-01],
               [ 2.67510772e-01],
               [-1.44260988e-01],
               [-1.31925300e-01],
               [-1.40492842e-01],
               [ 3.66884679e-01],
               [-7.33196214e-02],
               [-2.37641290e-01],
               [ 8.63954797e-02],
               [-3.54603946e-01],
               [-1.64954677e-01],
               [-1.66768909e-01],
               [ 2.65115470e-01],
               [-2.67326310e-02],
               [ 1.90494470e-02],
               [ 2.01399252e-02],
               [ 1.85269848e-01],
               [ 3.12340379e-01],
               [-7.60187730e-02],
               [ 3.67084801e-01],
               [-1.42874405e-01],
               [ 3.53076994e-01],
               [ 5.73639870e-01],
               [-5.71474545e-02],
               [ 2.35542566e-01],
               [-5.77156432e-02],
               [-4.53049004e-01],
               [ 3.39314580e-01],
               [-8.57157335e-02],
               [-7.08550513e-02],
               [-1.10733114e-01],
               [ 4.39240187e-01],
               [ 1.48108572e-01],
               [ 1.30714908e-01],
               [ 1.49635196e-01],
               [-8.71385261e-02],
               [ 1.14954792e-01],
               [-5.27218103e-01],
               [ 2.26064518e-01],
               [ 1.29441947e-01],
               [ 5.74211329e-02],
               [-1.23162612e-01],
               [ 3.11881155e-02],
               [-4.63831611e-02],
               [ 6.58696368e-02],
               [ 7.32444003e-02],
               [ 1.69132173e-01],
               [ 2.26934582e-01],
               [-1.55505002e-01],
               [-5.89721240e-02],
               [ 2.85838753e-01],
               [-5.33606671e-02],
               [-1.22301325e-01],
               [ 1.45119680e-02],
               [ 1.76495902e-04],
               [ 5.26192971e-02],
               [-3.84419113e-01],
               [ 1.76090270e-01],
               [ 7.77601898e-02],
               [ 1.27431780e-01],
               [-2.85411060e-01],
               [-1.52871339e-02],
               [ 9.64461565e-02],
               [ 2.20513716e-01],
               [ 3.99419039e-01],
               [-2.42917970e-01],
               [-8.69931132e-02],
               [ 1.89239711e-01],
               [ 7.58148491e-01],
               [ 1.58418175e-02],
               [ 1.52568683e-01],
               [ 4.55511082e-03],
               [-4.69688475e-01],
               [-1.62868828e-01],
               [ 1.95910186e-01],
               [-2.08530009e-01],
               [-2.78300017e-01],
               [-3.42124015e-01],
               [ 2.18873858e-01],
               [-3.95755082e-01],
               [ 9.37055126e-02],
               [ 1.48875579e-01],
               [ 1.49100319e-01],
               [-2.04567596e-01],
               [ 1.71684265e-01],
               [-2.26359323e-01],
               [ 6.35634437e-02],
               [ 9.16234404e-02],
               [-3.17165315e-01],
               [-2.62843430e-01],
               [-3.54202867e-01],
               [ 8.93417373e-02],
               [ 4.06244323e-02],
               [-1.18885770e-01],
               [ 5.08761816e-02],
               [-2.39023775e-01],
               [-4.83683944e-02],
               [-3.71447317e-02],
               [ 1.23371027e-01],
               [ 1.60136893e-02],
               [ 4.48763967e-02],
               [-1.95563927e-01],
               [-2.07804710e-01],
               [ 7.13674799e-02],
               [ 2.81322263e-02],
               [-1.17948651e-01],
               [ 2.00690493e-01],
               [-1.50289580e-01],
               [ 2.70880423e-02],
               [-1.61366791e-01],
               [ 4.07325089e-01],
               [-2.92455465e-01],
               [ 3.34634036e-01],
               [ 6.65683001e-02],
               [-2.89707690e-01],
               [ 3.55278879e-01],
               [ 5.28217442e-02],
               [-2.28844106e-01],
               [-4.77565564e-02],
               [-3.91775817e-01],
               [ 1.93901211e-01],
               [ 5.36942743e-02],
               [-1.17392592e-01],
               [-9.60891098e-02],
               [-3.87887051e-03],
               [-8.21977388e-03],
               [-4.66933668e-01],
               [-3.50650907e-01],
               [-1.49129003e-01],
               [ 3.35069686e-01],
               [ 2.14911886e-02],
               [-1.39698600e-02],
               [ 4.99249883e-02],
               [-1.67005528e-02],
               [ 3.42247263e-02],
               [ 1.02840647e-01],
               [ 1.40656456e-01],
               [ 6.08849637e-02],
               [ 3.59040409e-01],
               [-2.17587426e-02],
               [-4.03707027e-02],
               [-3.22823338e-02],
               [-9.04883724e-04],
               [ 8.65358785e-02],
               [ 5.82692176e-02],
               [-7.70860165e-02],
               [-1.47670716e-01],
               [ 2.74442941e-01],
               [-2.82569110e-01],
               [-3.18924606e-01],
               [-9.95331332e-02],
               [-9.68346745e-02],
               [-1.95574835e-01],
               [ 2.70811543e-02],
               [-2.63861269e-02],
               [ 3.44344616e-01],
               [ 2.39978865e-01],
               [-7.59349614e-02],
               [-2.37739563e-01],
               [ 4.21296179e-01],
               [ 1.09566078e-01],
               [ 3.38155627e-02],
               [ 1.08541623e-01],
               [ 5.93499005e-01]], dtype=float32),
    },
}),)
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py(209)<listcomp>()
-> all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 165, in <module>
    params, opt_state = trainStep(u_0_train, t, dt, params, net, opt_state)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 111, in trainStep
    updates, opt_state = optimizer.update(grads, opt_state)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/combine.py", line 54, in update_fn
    updates, new_s = fn(updates, s, params)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/transform.py", line 342, in update_fn
    mu = update_moment(updates, state.mu, b1, 1)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/transform.py", line 83, in update_moment
    return jax.tree_util.tree_map(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py", line 209, in tree_map
    all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py", line 209, in <listcomp>
    all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
ValueError: Expected tuple, got FrozenDict({
    Dense_0: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32),
    },
    Dense_1: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
               0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., ..., 0., 0., 0.],
               [0., 0., 0., ..., 0., 0., 0.],
               [0., 0., 0., ..., 0., 0., 0.],
               ...,
               [0., 0., 0., ..., 0., 0., 0.],
               [0., 0., 0., ..., 0., 0., 0.],
               [0., 0., 0., ..., 0., 0., 0.]], dtype=float32),
    },
    Dense_2: {
        bias: Array([0.], dtype=float32),
        kernel: Array([[0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.]], dtype=float32),
    },
}).
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(111)trainStep()
-> updates, opt_state = optimizer.update(grads, opt_state)
(FrozenDict({
    Dense_0: {
        bias: Array([ 0.00710389, -0.02987255, -0.01015279, -0.02701648, -0.00984157,
               -0.0054151 ,  0.00687236,  0.00335127, -0.01991976, -0.00367576],      dtype=float32),
        kernel: Array([[-3.0428725e-03,  6.0664103e-03,  5.0585234e-04, -1.4056496e-02,
                -5.8198390e-03, -3.6132829e-03, -2.8722435e-03, -1.3751435e-03,
                 8.4369769e-03,  1.1010010e-03],
               [ 1.0233696e-04, -6.2078857e-03, -2.4359049e-03, -4.9471147e-03,
                -1.5802613e-03, -6.4430624e-04, -1.6194522e-04, -9.5301344e-05,
                -1.0173975e-03, -6.2361237e-04]], dtype=float32),
    },
    Dense_1: {
        bias: Array([ 0.04108185, -0.00718579,  0.06652149, -0.03812231,  0.05005864,
               -0.00193057,  0.0387884 , -0.03484446,  0.03334873, -0.00041399],      dtype=float32),
        kernel: Array([[ 5.19962423e-03, -9.09487309e-04,  8.41945410e-03,
                -4.82504303e-03,  6.33579399e-03, -2.44347815e-04,
                 4.90934774e-03, -4.41017374e-03,  4.22086334e-03,
                -5.23970994e-05],
               [ 8.54569208e-03, -1.49476167e-03,  1.38375517e-02,
                -7.93006085e-03,  1.04130125e-02, -4.01590834e-04,
                 8.06861743e-03, -7.24821491e-03,  6.93707867e-03,
                -8.61157459e-05],
               [ 2.66414671e-03, -4.65996709e-04,  4.31390107e-03,
                -2.47222139e-03,  3.24628945e-03, -1.25197228e-04,
                 2.51541729e-03, -2.25965399e-03,  2.16265651e-03,
                -2.68468575e-05],
               [ 1.50868846e-02, -2.63890787e-03,  2.44293306e-02,
                -1.40000246e-02,  1.83835197e-02, -7.08983454e-04,
                 1.42446375e-02, -1.27962679e-02,  1.22469785e-02,
                -1.52031964e-04],
               [ 1.88491400e-02, -3.29697970e-03,  3.05213388e-02,
                -1.74912475e-02,  2.29678676e-02, -8.85784626e-04,
                 1.77968610e-02, -1.59873068e-02,  1.53010385e-02,
                -1.89944578e-04],
               [ 4.53521498e-03, -7.93272862e-04,  7.34361447e-03,
                -4.20849770e-03,  5.52620506e-03, -2.13124993e-04,
                 4.28203028e-03, -3.84664116e-03,  3.68152070e-03,
                -4.57017850e-05],
               [ 7.88300531e-04, -1.37884839e-04,  1.27645012e-03,
                -7.31511391e-04,  9.60552134e-04, -3.70448943e-05,
                 7.44292571e-04, -6.68614288e-04,  6.39913371e-04,
                -7.94377866e-06],
               [ 3.87127488e-03, -6.77140430e-04,  6.26853434e-03,
                -3.59238801e-03,  4.71718702e-03, -1.81924246e-04,
                 3.65515589e-03, -3.28350603e-03,  3.14255897e-03,
                -3.90112036e-05],
               [ 3.68191954e-03, -6.44019456e-04,  5.96192293e-03,
                -3.41667398e-03,  4.48645605e-03, -1.73025794e-04,
                 3.47637129e-03, -3.12290015e-03,  2.98884721e-03,
                -3.71030510e-05],
               [ 4.81380802e-03, -8.42002686e-04,  7.79472524e-03,
                -4.46702121e-03,  5.86567400e-03, -2.26217060e-04,
                 4.54507070e-03, -4.08293586e-03,  3.90767260e-03,
                -4.85092023e-05]], dtype=float32),
    },
    Dense_2: {
        bias: Array([-0.24086955], dtype=float32),
        kernel: Array([[ 0.04761195],
               [ 0.02191341],
               [-0.00170405],
               [-0.00850416],
               [ 0.03864259],
               [ 0.03596146],
               [ 0.12850152],
               [-0.02745076],
               [-0.02449497],
               [ 0.03768284]], dtype=float32),
    },
}),)
106  	def trainStep(u_0, t, dt, params, net, opt_state):
107  	  grads = jtr.tree_map(
108  	      lambda m: jnp.mean(m, axis=0),
109  	      vmap(grad(lossFn, argnums=(3,)),
110  	           in_axes=(0, None, None, None, None))(u_0, t, dt, params, net))
111 B->	  updates, opt_state = optimizer.update(grads, opt_state)
112  	  params = optax.apply_updates(params, updates)
113  	  return params, opt_state
114  	
115  	
116  	def metricCalc(u_0, t, dt, params, net):
ValueError: Expected tuple, got FrozenDict({
    Dense_0: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32),
    },
    Dense_1: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32),
    },
    Dense_2: {
        bias: Array([0.], dtype=float32),
        kernel: Array([[0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.]], dtype=float32),
    },
}).
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(111)trainStep()
-> updates, opt_state = optimizer.update(grads, opt_state)
--KeyboardInterrupt--
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py(209)<listcomp>()
-> all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 165, in <module>
    params, opt_state = trainStep(u_0_train, t, dt, params, net, opt_state,
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 111, in trainStep
    updates, opt_state = optUpdate(grads, opt_state)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/combine.py", line 54, in update_fn
    updates, new_s = fn(updates, s, params)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/transform.py", line 342, in update_fn
    mu = update_moment(updates, state.mu, b1, 1)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/transform.py", line 83, in update_moment
    return jax.tree_util.tree_map(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py", line 209, in tree_map
    all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py", line 209, in <listcomp>
    all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
ValueError: Expected tuple, got FrozenDict({
    Dense_0: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32),
    },
    Dense_1: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32),
    },
    Dense_2: {
        bias: Array([0.], dtype=float32),
        kernel: Array([[0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.]], dtype=float32),
    },
}).
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(111)trainStep()
-> updates, opt_state = optUpdate(grads, opt_state)
ValueError: Expected tuple, got FrozenDict({
    Dense_0: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32),
    },
    Dense_1: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32),
    },
    Dense_2: {
        bias: Array([0.], dtype=float32),
        kernel: Array([[0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.]], dtype=float32),
    },
}).
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(111)trainStep()
-> updates, opt_state = optUpdate(grads, opt_state)
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 165, in <module>
    params, opt_state = trainStep(u_0_train, t, dt, params, net, opt_state,
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 111, in trainStep
    updates, opt_state = optimizer.update(grads, opt_state)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/combine.py", line 54, in update_fn
    updates, new_s = fn(updates, s, params)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/transform.py", line 342, in update_fn
    mu = update_moment(updates, state.mu, b1, 1)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/transform.py", line 83, in update_moment
    return jax.tree_util.tree_map(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py", line 209, in tree_map
    all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py", line 209, in <listcomp>
    all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
ValueError: Expected tuple, got FrozenDict({
    Dense_0: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32),
    },
    Dense_1: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32),
    },
    Dense_2: {
        bias: Array([0.], dtype=float32),
        kernel: Array([[0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.]], dtype=float32),
    },
}).
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py(209)<listcomp>()
-> all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(111)trainStep()
-> updates, opt_state = optimizer.update(grads, opt_state)
(FrozenDict({
    Dense_0: {
        bias: Array([ 0.00710389, -0.02987255, -0.01015279, -0.02701648, -0.00984157,
               -0.0054151 ,  0.00687236,  0.00335127, -0.01991976, -0.00367576],      dtype=float32),
        kernel: Array([[-3.0428725e-03,  6.0664103e-03,  5.0585234e-04, -1.4056496e-02,
                -5.8198390e-03, -3.6132829e-03, -2.8722435e-03, -1.3751435e-03,
                 8.4369769e-03,  1.1010010e-03],
               [ 1.0233696e-04, -6.2078857e-03, -2.4359049e-03, -4.9471147e-03,
                -1.5802613e-03, -6.4430624e-04, -1.6194522e-04, -9.5301344e-05,
                -1.0173975e-03, -6.2361237e-04]], dtype=float32),
    },
    Dense_1: {
        bias: Array([ 0.04108185, -0.00718579,  0.06652149, -0.03812231,  0.05005864,
               -0.00193057,  0.0387884 , -0.03484446,  0.03334873, -0.00041399],      dtype=float32),
        kernel: Array([[ 5.19962423e-03, -9.09487309e-04,  8.41945410e-03,
                -4.82504303e-03,  6.33579399e-03, -2.44347815e-04,
                 4.90934774e-03, -4.41017374e-03,  4.22086334e-03,
                -5.23970994e-05],
               [ 8.54569208e-03, -1.49476167e-03,  1.38375517e-02,
                -7.93006085e-03,  1.04130125e-02, -4.01590834e-04,
                 8.06861743e-03, -7.24821491e-03,  6.93707867e-03,
                -8.61157459e-05],
               [ 2.66414671e-03, -4.65996709e-04,  4.31390107e-03,
                -2.47222139e-03,  3.24628945e-03, -1.25197228e-04,
                 2.51541729e-03, -2.25965399e-03,  2.16265651e-03,
                -2.68468575e-05],
               [ 1.50868846e-02, -2.63890787e-03,  2.44293306e-02,
                -1.40000246e-02,  1.83835197e-02, -7.08983454e-04,
                 1.42446375e-02, -1.27962679e-02,  1.22469785e-02,
                -1.52031964e-04],
               [ 1.88491400e-02, -3.29697970e-03,  3.05213388e-02,
                -1.74912475e-02,  2.29678676e-02, -8.85784626e-04,
                 1.77968610e-02, -1.59873068e-02,  1.53010385e-02,
                -1.89944578e-04],
               [ 4.53521498e-03, -7.93272862e-04,  7.34361447e-03,
                -4.20849770e-03,  5.52620506e-03, -2.13124993e-04,
                 4.28203028e-03, -3.84664116e-03,  3.68152070e-03,
                -4.57017850e-05],
               [ 7.88300531e-04, -1.37884839e-04,  1.27645012e-03,
                -7.31511391e-04,  9.60552134e-04, -3.70448943e-05,
                 7.44292571e-04, -6.68614288e-04,  6.39913371e-04,
                -7.94377866e-06],
               [ 3.87127488e-03, -6.77140430e-04,  6.26853434e-03,
                -3.59238801e-03,  4.71718702e-03, -1.81924246e-04,
                 3.65515589e-03, -3.28350603e-03,  3.14255897e-03,
                -3.90112036e-05],
               [ 3.68191954e-03, -6.44019456e-04,  5.96192293e-03,
                -3.41667398e-03,  4.48645605e-03, -1.73025794e-04,
                 3.47637129e-03, -3.12290015e-03,  2.98884721e-03,
                -3.71030510e-05],
               [ 4.81380802e-03, -8.42002686e-04,  7.79472524e-03,
                -4.46702121e-03,  5.86567400e-03, -2.26217060e-04,
                 4.54507070e-03, -4.08293586e-03,  3.90767260e-03,
                -4.85092023e-05]], dtype=float32),
    },
    Dense_2: {
        bias: Array([-0.24086955], dtype=float32),
        kernel: Array([[ 0.04761195],
               [ 0.02191341],
               [-0.00170405],
               [-0.00850416],
               [ 0.03864259],
               [ 0.03596146],
               [ 0.12850152],
               [-0.02745076],
               [-0.02449497],
               [ 0.03768284]], dtype=float32),
    },
}),)
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 165, in <module>
    params, opt_state = trainStep(u_0_train, t, dt, params, net, opt_state,
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 111, in trainStep
    updates, opt_state = tx.update(grads.unfreeze(), opt_state)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/combine.py", line 54, in update_fn
    updates, new_s = fn(updates, s, params)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/transform.py", line 342, in update_fn
    mu = update_moment(updates, state.mu, b1, 1)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/optax/_src/transform.py", line 83, in update_moment
    return jax.tree_util.tree_map(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py", line 209, in tree_map
    all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py", line 209, in <listcomp>
    all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
ValueError: Expected tuple, got FrozenDict({
    Dense_0: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32),
    },
    Dense_1: {
        bias: Array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32),
        kernel: Array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32),
    },
    Dense_2: {
        bias: Array([0.], dtype=float32),
        kernel: Array([[0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.],
               [0.]], dtype=float32),
    },
}).
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/tree_util.py(209)<listcomp>()
-> all_leaves = [leaves] + [treedef.flatten_up_to(r) for r in rest]
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(111)trainStep()
-> updates, opt_state = tx.update(grads.unfreeze(), opt_state)
AttributeError: 'tuple' object has no attribute 'unfreeze'
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(111)trainStep()
-> updates, opt_state = tx.update(grads.unfreeze(), opt_state)
(FrozenDict({
    Dense_0: {
        bias: Array([ 0.00710389, -0.02987255, -0.01015279, -0.02701648, -0.00984157,
               -0.0054151 ,  0.00687236,  0.00335127, -0.01991976, -0.00367576],      dtype=float32),
        kernel: Array([[-3.0428725e-03,  6.0664103e-03,  5.0585234e-04, -1.4056496e-02,
                -5.8198390e-03, -3.6132829e-03, -2.8722435e-03, -1.3751435e-03,
                 8.4369769e-03,  1.1010010e-03],
               [ 1.0233696e-04, -6.2078857e-03, -2.4359049e-03, -4.9471147e-03,
                -1.5802613e-03, -6.4430624e-04, -1.6194522e-04, -9.5301344e-05,
                -1.0173975e-03, -6.2361237e-04]], dtype=float32),
    },
    Dense_1: {
        bias: Array([ 0.04108185, -0.00718579,  0.06652149, -0.03812231,  0.05005864,
               -0.00193057,  0.0387884 , -0.03484446,  0.03334873, -0.00041399],      dtype=float32),
        kernel: Array([[ 5.19962423e-03, -9.09487309e-04,  8.41945410e-03,
                -4.82504303e-03,  6.33579399e-03, -2.44347815e-04,
                 4.90934774e-03, -4.41017374e-03,  4.22086334e-03,
                -5.23970994e-05],
               [ 8.54569208e-03, -1.49476167e-03,  1.38375517e-02,
                -7.93006085e-03,  1.04130125e-02, -4.01590834e-04,
                 8.06861743e-03, -7.24821491e-03,  6.93707867e-03,
                -8.61157459e-05],
               [ 2.66414671e-03, -4.65996709e-04,  4.31390107e-03,
                -2.47222139e-03,  3.24628945e-03, -1.25197228e-04,
                 2.51541729e-03, -2.25965399e-03,  2.16265651e-03,
                -2.68468575e-05],
               [ 1.50868846e-02, -2.63890787e-03,  2.44293306e-02,
                -1.40000246e-02,  1.83835197e-02, -7.08983454e-04,
                 1.42446375e-02, -1.27962679e-02,  1.22469785e-02,
                -1.52031964e-04],
               [ 1.88491400e-02, -3.29697970e-03,  3.05213388e-02,
                -1.74912475e-02,  2.29678676e-02, -8.85784626e-04,
                 1.77968610e-02, -1.59873068e-02,  1.53010385e-02,
                -1.89944578e-04],
               [ 4.53521498e-03, -7.93272862e-04,  7.34361447e-03,
                -4.20849770e-03,  5.52620506e-03, -2.13124993e-04,
                 4.28203028e-03, -3.84664116e-03,  3.68152070e-03,
                -4.57017850e-05],
               [ 7.88300531e-04, -1.37884839e-04,  1.27645012e-03,
                -7.31511391e-04,  9.60552134e-04, -3.70448943e-05,
                 7.44292571e-04, -6.68614288e-04,  6.39913371e-04,
                -7.94377866e-06],
               [ 3.87127488e-03, -6.77140430e-04,  6.26853434e-03,
                -3.59238801e-03,  4.71718702e-03, -1.81924246e-04,
                 3.65515589e-03, -3.28350603e-03,  3.14255897e-03,
                -3.90112036e-05],
               [ 3.68191954e-03, -6.44019456e-04,  5.96192293e-03,
                -3.41667398e-03,  4.48645605e-03, -1.73025794e-04,
                 3.47637129e-03, -3.12290015e-03,  2.98884721e-03,
                -3.71030510e-05],
               [ 4.81380802e-03, -8.42002686e-04,  7.79472524e-03,
                -4.46702121e-03,  5.86567400e-03, -2.26217060e-04,
                 4.54507070e-03, -4.08293586e-03,  3.90767260e-03,
                -4.85092023e-05]], dtype=float32),
    },
    Dense_2: {
        bias: Array([-0.24086955], dtype=float32),
        kernel: Array([[ 0.04761195],
               [ 0.02191341],
               [-0.00170405],
               [-0.00850416],
               [ 0.03864259],
               [ 0.03596146],
               [ 0.12850152],
               [-0.02745076],
               [-0.02449497],
               [ 0.03768284]], dtype=float32),
    },
}),)
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 165, in <module>
    params, opt_state = trainStep(u_0_train, t, dt, params, net, opt_state,
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 111, in trainStep
    updates, opt_state = tx.update(grads, opt_state)
AttributeError: 'tuple' object has no attribute 'unfreeze'
--KeyboardInterrupt--
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(111)trainStep()
-> updates, opt_state = tx.update(grads, opt_state)
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(111)trainStep()
-> updates, opt_state = tx.update(grads, opt_state)
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(112)trainStep()
-> params = optax.apply_updates(params, updates)
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(113)trainStep()
-> return params, opt_state
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(111)trainStep()
-> updates, opt_state = tx.update(grads, opt_state)
Deleted breakpoint 2 at /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py:111
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 178, in <module>
    u = forwardSolve(u_0_test[1], dt)
TypeError: forwardSolve() missing 2 required positional arguments: 'params' and 'net'
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(178)<module>()
-> u = forwardSolve(u_0_test[1], dt)
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
Program interrupted. (Use 'cont' to resume).
> /work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/dtypes.py(126)canonicalize_dtype()
-> return _canonicalize_dtype(config.x64_enabled, allow_opaque_dtype, dtype)
Restarting /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py with arguments:
	Main_no_matrix.py
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 1, in <module>
    import os
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 44, in adjointSolve
    _, dt_fine, t_fine, u_fine = refineSolution(u, dt, ref_factor)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 80, in refineSolution
    u_fine = jnp.interp(t_fine, t_coarse, u)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 238, in cache_miss
    outs, out_flat, out_tree, args_flat = _python_pjit_helper(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 180, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _ = infer_params_fn(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 311, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 480, in common_infer_params
    jaxpr, consts, canonicalized_out_shardings_flat = _pjit_jaxpr(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 918, in _pjit_jaxpr
    jaxpr, final_consts, out_type = _create_pjit_jaxpr(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 322, in memoized_fun
    ans = call(fun, *args)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 874, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts = pe.trace_to_jaxpr_dynamic(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 2049, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 2066, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py", line 952, in interp
    raise ValueError("xp and fp must be one-dimensional arrays of equal size")
jax._src.traceback_util.UnfilteredStackTrace: ValueError: xp and fp must be one-dimensional arrays of equal size
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 1, in <module>
    import os
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 44, in adjointSolve
    _, dt_fine, t_fine, u_fine = refineSolution(u, dt, ref_factor)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 80, in refineSolution
    u_fine = jnp.interp(t_fine, t_coarse, u)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py", line 952, in interp
    raise ValueError("xp and fp must be one-dimensional arrays of equal size")
ValueError: xp and fp must be one-dimensional arrays of equal size
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py(952)interp()
-> raise ValueError("xp and fp must be one-dimensional arrays of equal size")
*** Blank or comment
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
Breakpoint 3 at /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py:80
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(80)refineSolution()
-> u_fine = jnp.interp(t_fine, t_coarse, u)
Array([0. , 0.5, 1. ], dtype=float32)
Array([[1.       ],
       [1.2060668],
       [1.5119259]], dtype=float32)
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 179, in <module>
    u = forwardSolve(u_0_test[1], dt, params, net)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 44, in adjointSolve
    _, dt_fine, t_fine, u_fine = refineSolution(u, dt, ref_factor)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 80, in refineSolution
    u_fine = jnp.interp(t_fine, jnp.squeeze(t_coarse), jnp.squeeze(u))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 238, in cache_miss
    outs, out_flat, out_tree, args_flat = _python_pjit_helper(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 180, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _ = infer_params_fn(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/api.py", line 311, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 480, in common_infer_params
    jaxpr, consts, canonicalized_out_shardings_flat = _pjit_jaxpr(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 918, in _pjit_jaxpr
    jaxpr, final_consts, out_type = _create_pjit_jaxpr(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 322, in memoized_fun
    ans = call(fun, *args)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/pjit.py", line 874, in _create_pjit_jaxpr
    jaxpr, global_out_avals, consts = pe.trace_to_jaxpr_dynamic(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 2049, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py", line 2066, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py", line 952, in interp
    raise ValueError("xp and fp must be one-dimensional arrays of equal size")
jax._src.traceback_util.UnfilteredStackTrace: ValueError: xp and fp must be one-dimensional arrays of equal size
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1705, in main
    pdb._runscript(mainpyfile)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/pdb.py", line 1573, in _runscript
    self.run(statement)
  File "/opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py", line 580, in run
    exec(cmd, globals, locals)
  File "<string>", line 1, in <module>
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 179, in <module>
    u = forwardSolve(u_0_test[1], dt, params, net)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 44, in adjointSolve
    _, dt_fine, t_fine, u_fine = refineSolution(u, dt, ref_factor)
  File "/scratch1/07169/wgl/adjoint/python/Main_no_matrix.py", line 80, in refineSolution
    u_fine = jnp.interp(t_fine, jnp.squeeze(t_coarse), jnp.squeeze(u))
  File "/work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py", line 952, in interp
    raise ValueError("xp and fp must be one-dimensional arrays of equal size")
ValueError: xp and fp must be one-dimensional arrays of equal size
Uncaught exception. Entering post mortem debugging
Running 'cont' or 'step' will restart the program
> /work2/07169/wgl/frontera/PHO-ICES/adj-env/lib/python3.9/site-packages/jax/_src/numpy/lax_numpy.py(952)interp()
-> raise ValueError("xp and fp must be one-dimensional arrays of equal size")
Post mortem debugger finished. The /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py will be restarted
> /scratch1/07169/wgl/adjoint/python/Main_no_matrix.py(1)<module>()
-> import os
Program interrupted. (Use 'cont' to resume).
--Call--
> /opt/apps/intel19/python3/3.9.2/lib/python3.9/bdb.py(321)set_trace()
-> def set_trace(self, frame=None):